# GridTokenX Blockchain Node Configuration
# Version: 0.1.1 - Updated August 2025
# Complete production-ready configuration for GridTokenX P2P energy trading blockchain
# Supports Thailand's energy market integration with EGAT, MEA, PEA, and ERC compliance
# Features: PoA consensus, real-time energy trading, grid integration, bonus tokens

[node]
# Unique node identifier (will be auto-generated if not provided)
node_id = "gridtokenx-node-001"
# Node type: validator, trader, observer, grid_operator, authority
node_type = "validator"
# Node version for compatibility checking
version = "0.1.1"
# Data directory for this specific node
data_dir = "./data"
# Enable performance metrics collection
enable_metrics = true

[network]
# Network name (mainnet, testnet, devnet)
network_name = "gridtokenx-testnet"
# Network ID for transaction replay protection
network_id = 1001
# Chain ID
chain_id = 1001
# Genesis block hash (leave empty for auto-generation)
genesis_hash = ""
# Bootstrap nodes for initial connection
bootstrap_nodes = [
    "/ip4/127.0.0.1/tcp/9001/p2p/12D3KooWGRUcQZLQwGfXLrqzWqwNFR1F4xQ2cKWBgCBqC3vQvJGH",
    "/ip4/127.0.0.1/tcp/9002/p2p/12D3KooWHkPeqfyM4xRsGdHUiFYmWgZCfVNLm8K9Z5jGgXvP9QsZ"
]
# Maximum number of peers to maintain
max_peers = 50

[p2p]
# Local listening address
listen_addr = "/ip4/0.0.0.0/tcp/9000"
# External address for NAT traversal (optional)
external_addr = ""
# P2P port
port = 9000
# Maximum inbound connections
max_inbound_connections = 25
# Maximum outbound connections
max_outbound_connections = 25
# Connection timeout in seconds
connection_timeout = 30
# Enable mDNS discovery
enable_mdns = true

[p2p.gossip]
# Heartbeat interval in seconds
heartbeat_interval = 1
# Message TTL in seconds
message_ttl = 300
# Maximum message size in bytes
max_message_size = 1048576
# Mesh maintenance interval in seconds
mesh_maintenance_interval = 5

[api]
# API server host
host = "127.0.0.1"
# API server port
port = 8080
# Enable CORS
enable_cors = true
# CORS allowed origins
cors_origins = ["*"]
# Request timeout in seconds
request_timeout = 30

[api.rate_limit]
# Requests per minute per IP
requests_per_minute = 60
# Burst size
burst_size = 10
# Enable rate limiting
enabled = true

[storage]
# Database backend: sled (fast Rust-native), rocksdb, redis, memory
backend = "sled"
# Data directory path
path = "./data"
# Cache size in MB
cache_size = 128
# Enable compression
compression = true

[storage.sled]
# Sled-specific configuration for high-performance energy trading
# Cache size in MB for Sled database
cache_size_mb = 256
# Enable compression for storage efficiency
compression = true
# Database file mode for performance
mode = "HighThroughput"
# Flush frequency for durability vs performance balance
flush_every_ms = 1000
[storage.backup]
enabled = true
# Backup interval in hours
interval_hours = 24
# Backup directory
backup_dir = "./backups"
# Number of backups to keep
retention_count = 7

[storage.pruning]
# Enable pruning
enabled = false
# Blocks to keep (0 = keep all)
keep_blocks = 0
# Pruning interval in blocks
pruning_interval = 1000

[consensus]
# Consensus algorithm: poa (Proof of Authority) - optimized for energy trading
algorithm = "poa"
# Block time target in seconds (optimized for energy market needs)
block_time = 10
# Maximum block size in bytes
max_block_size = 1048576
# Gas limit per block
gas_limit = 10000000
# Minimum validator stake in tokens
min_validator_stake = 100000
# Enable instant finality for energy trading
instant_finality = true
# Maximum authorities for optimal performance
max_authorities = 21

[consensus.poa]
# PoA-specific configuration for GridTokenX
# Authority selection based on Thai energy sector entities
authority_round_duration = 600  # 10 minutes per authority round
# Authorities: EGAT, MEA, PEA, ERC and licensed entities
min_authorities = 4
max_authorities = 21
# Authority performance monitoring
performance_monitoring = true
# Emergency authority activation
emergency_protocol = true

[consensus.poa.authorities]
# Pre-approved authorities for energy trading network
# Format: authority_id = "public_key_or_address"
egat = "0x1234567890abcdef1234567890abcdef12345678"
mea = "0x2345678901bcdef12345678901bcdef123456789"
pea = "0x3456789012cdef123456789012cdef1234567890"
erc = "0x456789013def1234567890123def12345678901"

[consensus.validator]
# Maximum number of validators
max_validators = 21
# Validator rotation period in blocks
rotation_period = 1000
# Authority-based validator selection
authority_based_selection = true
# Minimum uptime requirement (%)
min_uptime_requirement = 99.0
[consensus.validator.slashing]
double_sign_slash_rate = 0.05
# Slash rate for downtime
downtime_slash_rate = 0.01
# Downtime threshold in blocks
downtime_threshold = 100

[consensus.validator.rewards]
# Block reward in tokens (base validator reward)
block_reward = 50000
# Transaction fee sharing rate with validators
fee_share_rate = 0.8
# Energy trading incentive rate
energy_incentive_rate = 0.1
# Maximum daily rewards per validator
max_daily_rewards = 1000000
# Performance bonus multiplier (0.0-2.0)
performance_bonus_multiplier = 1.5

[consensus.validator.bonus_rewards]
# Consensus participation bonus
consensus_participation_bonus = 10000
# High uptime bonus (>99% uptime)
high_uptime_bonus = 5000
# Grid stability contribution bonus
grid_stability_bonus = 15000
# Energy verification bonus (per verified energy transaction)
energy_verification_bonus = 100
# Governance participation bonus
governance_participation_bonus = 2000

[consensus.pow]
# Initial PoW difficulty
initial_difficulty = 1000
# Difficulty adjustment period in blocks
difficulty_adjustment = 144
# Target block time for PoW components in seconds
pow_block_time = 60

[energy]
# Energy to token conversion rate (1 kWh = X tokens)
energy_token_ratio = 1.0
# Minimum trade amount in kWh
min_trade_amount = 0.1
# Maximum trade amount in kWh
max_trade_amount = 10000.0

[energy.order_book]
# Maximum orders per trader
max_orders_per_trader = 100
# Default order expiration time in hours
default_expiration_hours = 24
# Minimum order size in kWh
min_order_size = 0.1

[energy.order_book.matching]
# Price tolerance for matching (%)
price_tolerance = 5.0
# Enable time preference for matching
time_preference = true
# Location preference weight
location_preference_weight = 0.1

[energy.carbon_credits]
# Enable carbon credit tracking
enabled = true
# Verification required for carbon credits
verification_required = true
# Maximum bonus tokens per transaction
max_bonus_per_transaction = 1000.0
# Daily bonus token limit per producer
daily_bonus_limit = 10000.0

[energy.carbon_credits.credit_rates]
# Carbon credit rates by energy source (bonus tokens per kWh)
solar = 0.0
wind = 0.0
hydro = 0.0
biomass = 0.0
geothermal = 0.0
nuclear = 0.0
# Traditional sources (no bonus)
natural_gas = 0.0
coal = 0.0
oil = 0.0

[energy.bonus_tokens]
# Enable bonus token system
enabled = true
# Base energy to token ratio (1 kWh = X base tokens)
base_token_ratio = 1.0

[energy.bonus_tokens.renewable_multipliers]
# Renewable energy bonus multipliers (multiplied by base tokens)
solar = 1.0      # 1 kWh solar = 1.0 tokens total (1 base + 0.0 bonus)
wind = 1.0       # 1 kWh wind = 1.0 tokens total (1 base + 0.0 bonus)
hydro = 1.0      # 1 kWh hydro = 1.0 tokens total (1 base + 0.0 bonus)
biomass = 1.0    # 1 kWh biomass = 1.0 tokens total (1 base + 0.0 bonus)
geothermal = 1.0 # 1 kWh geothermal = 1.0 tokens total (1 base + 0.0 bonus)
nuclear = 1.0    # 1 kWh nuclear = 1.0 tokens total (1 base + 0.0 bonus)

[energy.bonus_tokens.time_based_multipliers]
# Time-based bonus multipliers
peak_hours_bonus = 0.2    # Extra 0.2 tokens during peak hours
off_peak_bonus = 0.1      # Extra 0.1 tokens during off-peak hours
weekend_bonus = 0.05      # Extra 0.05 tokens on weekends
holiday_bonus = 0.1       # Extra 0.1 tokens on Thai holidays

[energy.bonus_tokens.grid_stability_bonus]
# Grid stability contribution bonuses
frequency_stability_bonus = 0.1   # Bonus for maintaining grid frequency
voltage_regulation_bonus = 0.1    # Bonus for voltage regulation
load_balancing_bonus = 0.15       # Bonus for load balancing services
emergency_response_bonus = 0.5    # Bonus for emergency grid support

[energy.bonus_tokens.quality_multipliers]
# Energy quality-based multipliers
high_quality_bonus = 0.1     # Power factor > 0.95, THD < 3%
medium_quality_bonus = 0.05  # Power factor > 0.90, THD < 5%
# No bonus for standard quality

[energy.bonus_tokens.volume_tiers]
# Volume-based bonus tiers (cumulative monthly production)
tier_1_threshold = 100.0    # kWh threshold for tier 1
tier_1_bonus = 0.02         # 2% bonus
tier_2_threshold = 1000.0   # kWh threshold for tier 2  
tier_2_bonus = 0.05         # 5% bonus
tier_3_threshold = 10000.0  # kWh threshold for tier 3
tier_3_bonus = 0.10         # 10% bonus

[energy.bonus_tokens.regional_multipliers]
# Regional bonus multipliers for grid support
bangkok_multiplier = 1.0
central_multiplier = 1.1     # 10% bonus for central region
northern_multiplier = 1.2   # 20% bonus for northern region
northeastern_multiplier = 1.3 # 30% bonus for northeastern region
southern_multiplier = 1.15  # 15% bonus for southern region

[energy.price_limits]
# Minimum price per kWh in tokens
min_price = 1000
# Maximum price per kWh in tokens
max_price = 10000
# Daily price change limit (%)
daily_change_limit = 50.0

[grid]
# Grid operator configurations
[[grid.grid_operators]]
name = "EGAT"
endpoint = "https://api.egat.co.th"
regions = ["central", "northern"]

[[grid.grid_operators]]
name = "MEA"
endpoint = "https://api.mea.or.th"
regions = ["bangkok", "metro"]

[[grid.grid_operators]]
name = "PEA"
endpoint = "https://api.pea.co.th"
regions = ["provincial"]

[grid.scada]
# Enable SCADA integration
enabled = false
# SCADA protocol (modbus, dnp3, iec61850)
protocol = "modbus"

[grid.scada.connection]
host = "127.0.0.1"
port = 502
unit_id = 1
timeout = 30

[grid.smart_meters]
# Enable smart meter integration
enabled = false
# Communication protocol
protocol = "mqtt"
# Reading interval in seconds
reading_interval = 60

[grid.smart_meters.validation]
# Maximum reading deviation (%)
max_deviation = 10.0
# Minimum reading interval in seconds
min_interval = 30
# Enable anomaly detection
anomaly_detection = true

[grid.stability_monitoring]
# Monitor frequency stability
monitor_frequency = true
# Monitor voltage stability
monitor_voltage = true

[grid.stability_monitoring.thresholds]
# Frequency deviation limit in Hz
frequency_deviation = 0.5
# Voltage deviation limit (%)
voltage_deviation = 5.0
# Load imbalance threshold (%)
load_imbalance = 10.0

[governance]
# Enable governance features
enabled = true
# Voting period in days
voting_period_days = 7
# Quorum threshold (0.0-1.0)
quorum_threshold = 0.5

[governance.proposal]
# Minimum stake required to create proposal
min_stake_to_propose = 1000000
# Proposal fee in tokens
proposal_fee = 10000
# Execution delay in days after approval
execution_delay_days = 2

[security]
[security.crypto]
# Signature algorithm (Ed25519, ECDSA)
signature_algorithm = "Ed25519"
# Hash algorithm (SHA256, Blake2b)
hash_algorithm = "SHA256"

[security.crypto.key_derivation]
# Key derivation algorithm
algorithm = "PBKDF2"
# Iteration count
iterations = 100000
# Salt length in bytes
salt_length = 32

[security.network_security]
# Enable DDoS protection
ddos_protection = true
# IP whitelist (empty = allow all)
ip_whitelist = []
# IP blacklist
ip_blacklist = []

[security.network_security.connection_limits]
# Maximum connections per IP
max_connections_per_ip = 10
# Connection rate limit per minute
connection_rate_limit = 100
# Ban duration in seconds
ban_duration = 3600

[security.access_control]
# Require API authentication
require_auth = false

[security.access_control.jwt]
# JWT secret key (change in production!)
secret_key = "change-this-secret-key-in-production"
# Token expiration in hours
expiration_hours = 24
# JWT issuer
issuer = "gridtokenx"

[security.access_control.rbac]
# Enable role-based access control
enabled = false
# Default user role
default_role = "observer"

[logging]
# Log level (trace, debug, info, warn, error)
level = "info"
# Log format (json, pretty)
format = "pretty"

[logging.file_logging]
# Enable file logging
enabled = true
# Log file path
file_path = "./logs/gridtokenx.log"

[logging.file_logging.rotation]
# Maximum file size in MB
max_size_mb = 100
# Number of files to keep
keep_files = 10
# Rotation interval
rotation_interval = "daily"

[logging.metrics]
# Enable metrics collection
enabled = true
# Metrics endpoint
endpoint = "/metrics"
# Collection interval in seconds
collection_interval = 60

[monitoring]
# Enable comprehensive system monitoring
enabled = true
# Monitoring interval in seconds
interval = 30
# Performance metrics collection
performance_metrics = true
# Network metrics collection
network_metrics = true
# Energy trading metrics
energy_metrics = true

[monitoring.prometheus]
# Prometheus metrics configuration
enabled = true
# Prometheus scrape endpoint
endpoint = "/metrics"
# Metrics port (separate from API port)
port = 9090
# Histogram buckets for latency metrics
latency_buckets = [0.001, 0.01, 0.1, 1.0, 10.0]

[monitoring.alerts]
# Alert configuration for system health
enabled = true
# Alert thresholds
high_memory_threshold = 0.8  # 80% memory usage
high_cpu_threshold = 0.8     # 80% CPU usage
low_disk_threshold = 0.1     # 10% disk space remaining
# Network alert thresholds
high_network_latency = 1000  # 1 second
low_peer_count = 5           # Minimum peer connections

[thai_market]
[thai_market.erc_compliance]
# Enable ERC (Energy Regulatory Commission) compliance
enabled = true
# ERC API endpoint
erc_api_endpoint = "https://api.erc.or.th"
# Compliance check interval in hours
check_interval_hours = 24

[thai_market.peak_hours]
# Peak hours start (24-hour format)
start_hour = 18
# Peak hours end (24-hour format)
end_hour = 22
# Peak hour pricing multiplier
pricing_multiplier = 1.5
# Enable weekend peak hours
weekend_peak_enabled = false

[thai_market.regions]
# Default region
default_region = "central"
# Grid zones
grid_zones = ["zone1", "zone2", "zone3", "zone4"]

[thai_market.regions.regional_multipliers]
# Regional pricing multipliers
bangkok = 1.2
central = 1.0
northern = 0.9
northeastern = 0.8
southern = 1.1

[thai_market.currency]
# Base currency
base_currency = "THB"
# Exchange rate source API
exchange_rate_source = "https://api.exchangerate-api.com"
# Rate update interval in hours
rate_update_interval = 1

[telemetry]
# Telemetry and observability configuration
enabled = true
# Telemetry collection endpoint
endpoint = "http://localhost:4317"
# Service name for tracing
service_name = "gridtokenx-node"
# Sample rate for distributed tracing (0.0-1.0)
trace_sample_rate = 0.1
# Enable span collection
enable_spans = true
# Enable custom metrics
enable_custom_metrics = true

[performance]
# Performance optimization settings
# Thread pool size for async operations (0 = auto-detect)
async_thread_pool_size = 0
# I/O thread pool size
io_thread_pool_size = 4
# Memory pool size for transactions (MB)
transaction_pool_size_mb = 64
# Maximum pending transactions
max_pending_transactions = 10000
# Cache configuration
enable_caching = true
cache_ttl_seconds = 300

[performance.optimization]
# Advanced performance optimizations
# Enable zero-copy operations where possible
enable_zero_copy = true
# Batch size for database operations
db_batch_size = 1000
# Network buffer sizes (bytes)
network_recv_buffer_size = 65536
network_send_buffer_size = 65536
# Consensus optimization
enable_fast_sync = true
# Parallel transaction validation
parallel_validation = true

[backup]
# Enhanced backup and recovery configuration
enabled = true
# Backup strategy: incremental, full, or smart
strategy = "smart"
# Backup interval in hours
interval_hours = 6
# Remote backup configuration
remote_backup = true
# Backup encryption
encrypt_backups = true
# Retention policy
max_backups = 168  # 7 days * 24 hours

[development]
# Development and testing specific configuration
# Enable hot reloading for development
hot_reload = false
# Enable debug endpoints
debug_endpoints = false
# Test mode (disables certain security features)
test_mode = false
# Mock external services for testing
mock_services = false
# Enhanced logging for development
verbose_logging = false

[experimental]
# Experimental features (use with caution in production)
enabled = false
# Feature flags for new capabilities
features = []
# Experimental consensus optimizations
consensus_optimizations = false
# Experimental P2P improvements
p2p_optimizations = false
